---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by PC.
--- DateTime: 2022/6/27 15:37
---


local ApplicationGuideInfo = require("Guide.ApplicationGuide.ApplicationGuideInfo")
--- 战斗中pu待使用1秒后未点击时
---@class  MakeFoodKitchenViewGuide : ApplicationGuideInfo
local MakeFoodKitchenViewGuide = ApplicationGuideInfo:New()
local this = MakeFoodKitchenViewGuide

function MakeFoodKitchenViewGuide:Init()
    if not ModelList.GuideModel:IsGuiding() then
        this:Register()
    end
    this:DelayShowFinger(true)
end

function MakeFoodKitchenViewGuide:Remove()
    this:UnRegister()
    this:DelayShowFinger(false)
end


function MakeFoodKitchenViewGuide:DelayShowFinger(isStart)
    if isStart then
        if this.delay_show then
            LuaTimer:Remove(this.delay_show)
            this.delay_show = nil
        end
        this:PlayFingerEffect(nil,true)
        this.delay_show = LuaTimer:SetDelayFunction(this.data[1].delay_time,function()
            local view = ViewList[this.data[1].view].go
            if view then
                for i = 1, #this.data[1].path do
                    local childPath = string.gsub(this.data[1].path[i],this.data[1].view.."/","")
                    local obj = fun.find_child(view, childPath)
                    if fun.get_active_self(obj) then
                        --log.r("foodmake  show finger")
                        this:PlayFingerEffect(obj,false,this.data[1])
                        break
                    end
                end
            end
            this.delay_show = nil
        end)
    else
        this:PlayFingerEffect(nil,true)
        if this.delay_show then
            LuaTimer:Remove(this.delay_show)
            this.delay_show = nil
        end
    end
end

function this:Register()
    Event.AddListener(EventName.ApplicationGuide_ResetFinger,this.DelayShowFinger)
end


function this:UnRegister()
    Event.RemoveListener(EventName.ApplicationGuide_ResetFinger,this.DelayShowFinger)
end

return this