---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by PC.
--- DateTime: 2022/3/23 15:29
---  全局战斗 machine list

require("Combat/GlobalBattleMachineConfig")

GlobalBattleMachineList = {
    BattleSoundMachine =  require 'Combat.GlobalMachine.BattleSoundMachine',
    DelayFuncMachine =  require 'Combat.GlobalMachine.DelayFuncMachine',
}
local this = GlobalBattleMachineList


local GetBattleTypeStr = function()
    local gameType = ModelList.BattleModel:GetGameType()
    if gameType ~= PLAY_TYPE.PLAY_TYPE_AUTO_TICKET then
        return "PLAY_TYPE_NORMAL"
    else
        return "PLAY_TYPE_AUTO_TICKET"
    end
end

function GlobalBattleMachineList.StartBattleGlobalMachine()
    local typeStr = GetBattleTypeStr()
    for k, v in pairs(GlobalBattleMachineList) do
        if type(v) ~= "function" and GlobalBattleMachineConfig[typeStr][k] and
                GlobalBattleMachineConfig[typeStr][k] == 1 then
            v:Start()
            if v.Register then v.Register() end
        end
    end
    this.MachineEnabled = true
end

function GlobalBattleMachineList.StopBattleGlobalMachine()
    local typeStr = GetBattleTypeStr()
    for k, v in pairs(GlobalBattleMachineList) do
        if type(v) ~= "function"  and type(v)~= "boolean"  and
                GlobalBattleMachineConfig[typeStr][k] then
            v:Stop()
            if v.UnRegister then v.UnRegister() end
        end
    end
    this.MachineEnabled = false
end

function GlobalBattleMachineList.PauseBattleGlobalMachine(isPause)
    for k, v in pairs(GlobalBattleMachineList) do
        if type(v) ~= "function" then
            v:Pause(isPause)
        end
    end
end


