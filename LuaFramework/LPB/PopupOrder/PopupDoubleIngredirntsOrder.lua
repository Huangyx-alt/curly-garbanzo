---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by PC.
--- DateTime: 2022/8/29 11:55
---

--- 双倍美食 弹窗order

local BaseOrder = require "PopupOrder/BaseOrder"
local PopupOrder = Clazz(BaseOrder, "")
local this = PopupOrder

local isPopup = false

function PopupOrder.Execute(arg)
    --local isLoginOpen = (ModelList.ActivityModel:IsActivityLoginOpen(ActivityTypes.doubleFood) or
            --ModelList.ActivityModel:IsActivityFirstOpen(ActivityTypes.doubleFood)  ) or false
    if ModelList.ActivityModel:IsActivityAvailable(ActivityTypes.doubleFood) and not isPopup then
        isPopup = true
        Event.AddListener(EventName.Event_popup_activity_double_ingredirnts_finish, PopupOrder.Finish, this)
        Facade.SendNotification(NotifyName.ShowUI, ViewList.DoubleIngredirntsPromotedView)
    else
        if not ModelList.ActivityModel:IsActivityAvailable(ActivityTypes.doubleFood) then
            isPopup = false
        end
        PopupOrder.Finish()
    end
end

function PopupOrder.Finish()
    ModelList.ActivityModel:RemoveLoginOpenActivity(ActivityTypes.doubleFood)
    Event.RemoveListener(EventName.Event_popup_activity_double_ingredirnts_finish,PopupOrder.Finish,this)
    log.g("brocast  EventName.Event_popup_order_finish ")
    Event.Brocast(EventName.Event_popup_order_finish,true)
end

return PopupOrder