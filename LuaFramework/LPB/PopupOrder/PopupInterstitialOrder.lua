---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by PC.
--- DateTime: 2022/8/2 16:05
---

local BaseOrder = require "PopupOrder/BaseOrder"
local PopupOrder = Clazz(BaseOrder, "")
local this = PopupOrder

local isPlay = false
local isShowAd = false
function PopupOrder.Execute()
    if ModelList.AdModel.IsInterstitialAdCDOver() and (SDK and SDK.IsInterstitialAdReady()) then
        log.r("PopupOrder. inter    Execute")
        isPlay = true
        isShowAd = true
        Event.AddListener(EventName.Event_Interstitial_Show_Over, this.TryShowNoAdPop)
        Facade.SendNotification(NotifyName.ShowUI, ViewList.AdBreakView, nil)
        --ModelList.AdModel.delayPlayAd = false
    else
        Event.Brocast(EventName.Event_popup_order_finish, true)
        --this.Finish()
    end
end

function PopupOrder.TryShowNoAdPop()
    Event.AddListener(EventName.Event_Interstitial_Gift_Show_Over, this.Finish)
    if isShowAd then
        isShowAd = false
        if not ModelList.GiftPackModel:ShowNoAdPack() then
            this.Finish()
        end
    end
end

function PopupOrder.Finish()
    if isPlay then
        Event.RemoveListener(EventName.Event_Interstitial_Show_Over, this.TryShowNoAdPop, this)
        Event.RemoveListener(EventName.Event_Interstitial_Gift_Show_Over, this.Finish, this)
        log.g("brocast  PopupOrder PopupInterstitialOrder finish")
        isPlay = false
        isShowAd = false
        Event.Brocast(EventName.Event_popup_order_finish, true)
    end
end

return PopupOrder
