---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by PC.
--- DateTime: 2022/8/26 9:38
---

VipSescriptionSliderItem = BaseView:New("VipSescriptionSliderItem")
local this = VipSescriptionSliderItem

local CurrVipLv =0
local MaxVipLv =0

this.auto_bind_ui_items = {
    "Slider",
    "currVipIcon",
    "nextVipIcon",
    "currVipLevel",
    "nextVipLevel",
    "sliderText",
    "Anima",
    "MaxTip",
}

function VipSescriptionSliderItem:New(parasitifer)
    local o = {}
    this.__index = this
    setmetatable(o,this)
    o._parasitifer = parasitifer or ParasitiferType.other
    return o
end


function VipSescriptionSliderItem:Init(obj)
    this:on_init(obj)
end


--- vip介绍面板使用
function VipSescriptionSliderItem:SetVipInfo(call_back)
    --this:Reset()
    CurrVipLv = ModelList.PlayerInfoModel:GetVIP()
    MaxVipLv = #Csv.vip
    local vipPts = ModelList.PlayerInfoModel:GetVipPts()

    local vipInfo = Csv.GetData("vip",CurrVipLv)
    this:SetVipIcon(CurrVipLv,this.currVipIcon,this.currVipLevel)
    if CurrVipLv < MaxVipLv then
        this:SetVipIcon(CurrVipLv+1,this.nextVipIcon,this.nextVipLevel)
        local progress = vipPts/vipInfo.exp
        this.Slider.value = math.floor(progress * 100) * 0.01
        this.sliderText.text = tostring(math.floor(progress * 100)) .. "%"
    else
        --this.Slider.value = 1
        --this.sliderText.text = "MAX"
        fun.set_active(this.Slider,false)
        fun.set_active(this.nextVipIcon,false)
        fun.set_active(this.nextVipLevel,false)
        fun.set_active(this.MaxTip,true)
        --this:SetVipMaxIcon(this.nextVipIcon,this.nextVipLevel)
        call_back()
    end
end

function VipSescriptionSliderItem:SetVipIcon(vipLv,vipIcon,vipText)
    local vipInfo = Csv.GetData("vip", vipLv)
    vipIcon.sprite = AtlasManager:GetSpriteByName("VipAtlas", vipInfo.icon)
    vipText.sprite = AtlasManager:GetSpriteByName("VipAtlas", "VipNub" .. vipLv)
end

function VipSescriptionSliderItem:SetVipMaxIcon(vipIcon,vipText)
    vipIcon.sprite = AtlasManager:GetSpriteByName("VipAtlas", "vipMax1")
    fun.set_active(vipText,false)
    fun.set_active(this.vipMax,true)
end







return this

