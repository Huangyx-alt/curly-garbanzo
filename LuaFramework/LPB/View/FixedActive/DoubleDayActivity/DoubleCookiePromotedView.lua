---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by PC.
--- DateTime: 2022/8/31 15:46
---

--- 杯赛弹窗界面

local CompetitionPromotedView = BaseView:New('DailyCompetitionCookiePromotedView');

require("State.Activity.DoubleIngredirnts.DoubleIngredirntsEnterState")
require("State.Activity.DoubleCookie.DoubleCookieExitState")
require("State.Activity.DoubleIngredirnts.DoubleIngredirntsIdleState")

require "View/CommonView/RemainTimeCountDown"

local this = CompetitionPromotedView;
this.viewType = CanvasSortingOrderManager.LayerType.TopConsole

local remainTimeCountDown = RemainTimeCountDown:New()

this.auto_bind_ui_items = {
    "btn_continue",
    "anima",
}

local isPopup = false

function CompetitionPromotedView.Awake(obj)
    --this.update_x_enabled = true
    this:on_init()

end

function CompetitionPromotedView:OnEnable(params)
    FsmCreator:Create("CompetitionPromotedView",this,{
        DoubleIngredirntsEnterState:New(),
        DoubleCookieExitState:New(),
        DoubleIngredirntsIdleState:New(),
    })
    this._fsm:StartFsm("DoubleIngredirntsEnterState")
    isPopup = params
    UISound.play("competition_pop_up")
end

function CompetitionPromotedView:OnDisable()
    remainTimeCountDown:StopCountDown()
end

function CompetitionPromotedView:PlayEnter()
    this.anima:Play("in")
    ModelList.ActivityModel:RemoveLoginOpenActivity(ActivityTypes.doubleCookies)
    SDK.double_window_open(3)
end

function CompetitionPromotedView:PlayExit()
    this.anima:Play("out")
end

function CompetitionPromotedView:CloseView()
    this._fsm:ChangeState("DoubleCookieExitState")
    if isPopup then
        Event.Brocast(EventName.Event_popup_activity_double_cookie_finish)
    end
end

function CompetitionPromotedView:on_btn_close_click()
    this._fsm:GetCurState():CloseView()
end
function CompetitionPromotedView:on_btn_continue_click()
    this._fsm:GetCurState():CloseView()
end

return this