---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Administrator.
--- DateTime: 8/11/2024 上午 11:14
---

local GrowTrainState = Clazz(BaseFsmState, "GrowTrainState")
local this = GrowTrainState

function GrowTrainState:New()
    local o = {}
    setmetatable(o, { __index = GrowTrainState })
    return o
end

function GrowTrainState:InitState()
end

function GrowTrainState:OnEnter(fsm, previous)
    self._fsm = fsm
    self._owner = fsm:GetOwner()
    self.cardId, self.bingoOrder = self._owner:GetCardBingoCellsInfo()
    log.EditorLog("enter GrowTrainState")
    self:PlayEffect()
end

---播放划线动效
---@param centerPos : 居中格子的坐标
---@param direction : 方向:1横向2竖3斜左4斜右5四角
function GrowTrainState:PlayEffect()
    log.EditorLog("GrowTrainState  PlayEffect")
    --local defaultItem = ViewList.GoldenTrainBingoView:GetCardView():GetCard(self.cardId):GetDefaultItem()
    log.EditorLog("GrowTrainState  PlayEffect  defaultItem")
    --if defaultItem then
    --    --- 设置火车的数字
    --    local anima = fun.get_component(defaultItem, fun.ANIMATOR)
    --    if anima then
    --        log.EditorLog("GrowTrainState  PlayEffect  shou")
    --        anima:Play("shou")
    --    end
    --end
    log.EditorLog("GrowTrainState  SetDelayFunction  shou")
    LuaTimer:SetDelayFunction(1, function ()

        self._fsm:ChangeState("CardWinState")

    end)
end

function GrowTrainState:on_x_update()
    if anima then
        if anima:GetCurrentAnimatorStateInfo(0):IsName("idle") then
            this:stop_x_update()
            this:PlayOver()
        end
    end
end

function GrowTrainState:Finish()

end

function GrowTrainState:OnLeave(fsm)
    self._fsm = nil
    self._owner = nil
    self._posX = nil
end

function GrowTrainState:Dispose()
    self:OnLeave(nil)
end

return this
