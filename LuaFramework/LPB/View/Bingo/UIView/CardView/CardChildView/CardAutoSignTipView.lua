---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by PC.
--- DateTime: 2022/10/31 10:15
---

--- 34卡牌自动点击提示

local BaseCardAutoSignTipView = require("View.Bingo.UIView.CardView.CardChildView.BaseCardAutoSignTipView")

local CardAutoSignTipView = BaseCardAutoSignTipView:New()
local this = CardAutoSignTipView
this.name = "CardAutoSignTipView"
this.prefabName = "AutoSignTip"

---所有卡牌的自动盖章提示
this.allTips = {}

---
this.destory_timer = {}

this.showingCardIds = {}

function CardAutoSignTipView:ShowTip(target,cardId)
    if fun.is_include(cardId,this.showingCardIds) then
        return
    end
    table.insert(this.showingCardIds,cardId)
    Cache.load_prefabs(AssetList[this.prefabName],this.prefabName,function(prefab)
        local obj = fun.get_instance(prefab,target)
        table.insert(this.allTips,obj)
        fun.set_same_position_with(obj,target)
        --fun.set_parent(obj,target)
        local refTemp = fun.get_component(obj,fun.REFER)
        refTemp:Get("tip1").text = Csv.GetDescription(970)
        refTemp:Get("tip2").text = Csv.GetDescription(971)
        local twoSecondDelay = LuaTimer:SetDelayFunction(2,function()
            this:HideTip()
        end)
        table.insert(this.destory_timer,twoSecondDelay)
    end)
end

function CardAutoSignTipView:HideTip()
    if #this.allTips > 0 then
        Destroy(this.allTips[1])
        table.remove(this.allTips,1)
    end
    if #this.destory_timer > 0 then
        table.remove(this.destory_timer,1)
    end
    if #this.showingCardIds > 0 then
        table.remove(this.showingCardIds,1)
    end
end

function CardAutoSignTipView:HideAllTip()
    if #this.allTips > 0 then
        for i = 1, #this.allTips do
            Destroy(this.allTips[i])
        end
        this.allTips = {}
    end
    if #this.destory_timer > 0 then
        for i = 1, #this.destory_timer do
            LuaTimer:Remove(this.destory_timer[i])
        end
        this.destory_timer = {}
    end
    this.showingCardIds = {}
end

function CardAutoSignTipView:Register()

end

function CardAutoSignTipView:UnRegister()

end

return this
