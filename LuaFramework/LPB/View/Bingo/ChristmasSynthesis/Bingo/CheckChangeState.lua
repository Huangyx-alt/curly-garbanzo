---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Administrator.
--- DateTime: 26/11/2024 下午 3:23
---



local CheckChangeState = Clazz(BaseFsmState, "CheckChangeState")
local this = CheckChangeState

function CheckChangeState:New()
    local o = {}
    setmetatable(o, { __index = CheckChangeState })
    return o
end

function CheckChangeState:InitState()
end

function CheckChangeState:OnEnter(fsm, previous)
    log.EditorLog(tostring(fsm:GetOwner():GetCardId()) .. " enterstate  " .. "CheckChangeState:OnEnter")
    self._fsm = fsm
    self._owner = fsm:GetOwner()
    self:CheckNextState(previous)
end

function CheckChangeState:CheckNextState(previous)
    if previous == "BoxSignState" then
        ---是否形成新的Bingo,如果有,则进入BoxSignState,如果无,则进入BoxAllExitState
        if self._owner:IsGetNewBingo() then
            self:ChangeState(self._fsm, "BoxSignState")
        else
            self:ChangeState(self._fsm, "BoxAllExitState")
        end
    elseif previous == "BoxAllExitState" then
        ---是否形成新的Bingo,如果有,则进入BoxSignState,如果无,则进入BoxAllExitState
        if self._owner:IsGetNewBingo() then
            self:ChangeState(self._fsm, "BoxSignState")
        else
            self:ChangeState(self._fsm, "ShowFrameState")
        end
    elseif previous == "ShowFrameState" then
        self:ChangeState(self._fsm, "ShowNewGiftState")
    elseif previous == "ShowNewGiftState" then
        if self._owner:IsGetNewBingo() then
            self:ChangeState(self._fsm, "BoxSignState")
            --elseif not self._owner:IsShowBingoEffect() then
        --    self:ChangeState(self._fsm, "ShowFirstBingoState")
        else
            self:ChangeState(self._fsm, "ShowTxtRollState")
        end
    elseif previous == "ShowTxtRollState" then
        self:ChangeState(self._fsm, "IdleState")
    end
end

function CheckChangeState:Finish()

end

function CheckChangeState:OnLeave(fsm)
    self._fsm = nil
    self._owner = nil
    self._posX = nil
end

function CheckChangeState:Dispose()
    self:OnLeave(nil)
end

return this
