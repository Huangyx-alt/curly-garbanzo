-----
----- Generated by EmmyLua(https://github.com/EmmyLua)
----- Created by PC.
----- DateTime: 2022/2/17 16:27
-----
--
--require("View/Bingo/FsmCreator")
--require "State.FoodBagClaim.FoodBagClaimEnterState"
--require "State.FoodBagClaim.FoodBagClaimExitState"
--require "State.FoodBagClaim.FoodBagClaimTurnState"
--require "State.FoodBagClaim.FoodBagClaimShowState"
--require "State.FoodBagClaim.FoodBagClaimIdleState"
--require "State.FoodBagClaim.FoodBagClaimFlyItemState"
--require "State.FoodBagClaim.FoodBagClaimDoubleState"
--
--FoodBagClaimView = BaseDialogView:New("FoodBagClaimView","FoodBagClaimAtlas")
--local this = FoodBagClaimView
--this.viewType = CanvasSortingOrderManager.LayerType.PackageDialog
--
--local openClick =false
--local waitOpenAnimaOver = false
--
--this.auto_bind_ui_items = {
--    "view",
--    "btn_get",
--    "bagCount0",
--    "bagCount1",
--    "bagCount2",
--    "bagCount3",
--    "bagCount4",
--    "bagCount5",
--    "itemParent",
--    "bagAnima"
--}
--
--function FoodBagClaimView:New()
--    local o = {}
--    self.__index = self
--    setmetatable(o,self)
--    return o
--end
--
--function FoodBagClaimView:Awake()
--    self:on_init()
--end
--
--local  function GetFoodBagCount()
--    local foodBags = ModelList.CityModel:GetCityFoodBag()
--    this.bagCount = 0
--    for i = 1, #foodBags do
--        for k,v in pairs(foodBags) do
--            if v.value > 0 then
--                this.bagCount = this.bagCount + v.value
--            end
--        end
--    end
--end
--
--function FoodBagClaimView:OnEnable()
--    openClick = false
--    waitOpenAnimaOver = false
--    self:RegisterEvent()
--    self:BuildFsm()
--    GetFoodBagCount()
--    this.bagCount5.text =this.bagCount
--
--    --UISound.play("food_bag")
--end
--
--function FoodBagClaimView:SetData()
--    this.view.enabled = true
--    this.view:Play("exit")
--    LuaTimer:SetDelayFunction(1,function()
--        Facade.SendNotification(NotifyName.CloseUI, ViewList.FoodBagClaimView)
--    end)
--end
--
--
--function FoodBagClaimView:BuildFsm()
--    FsmCreator:Create("FoodBagClaimView",this,{
--        FoodBagClaimEnterState:New(),
--        FoodBagClaimShowState:New(),
--        FoodBagClaimExitState:New(),
--        FoodBagClaimTurnState:New(),
--        FoodBagClaimIdleState:New(),
--        FoodBagClaimFlyItemState:New(),
--        FoodBagClaimDoubleState:New(),
--    })
--    this.state = {
--        FoodBagClaimEnterState = "FoodBagClaimEnterState",
--        FoodBagClaimShowState = "FoodBagClaimShowState",
--        FoodBagClaimExitState = "FoodBagClaimExitState",
--        FoodBagClaimTurnState = "FoodBagClaimTurnState",
--        FoodBagClaimIdleState = "FoodBagClaimIdleState",
--        FoodBagClaimFlyItemState = "FoodBagClaimFlyItemState",
--        FoodBagClaimDoubleState = "FoodBagClaimDoubleState",
--    }
--    this._fsm:StartFsm(this.state.FoodBagClaimEnterState,this,this)
--end
--
--function FoodBagClaimView:OnDisable()
--    FsmCreator:DisposeFsm(this)
--    Event.Brocast(EventName.Event_show_treasure_box_animafinish)
--end
--
--function FoodBagClaimView:RegisterEvent()
--    Event.AddListener(EventName.Event_show_treasure_box_refresh,self.RefreshFoodBagClaimView)
--end
--
--function FoodBagClaimView:UnRegisterEvent()
--    Event.RemoveListener(EventName.Event_show_treasure_box_refresh,self.RefreshFoodBagClaimView)
--end
--
--function FoodBagClaimView:RefreshFoodBagClaimView(data)
--    this._fsm:ChangeState(this.state.FoodBagClaimShowState,this,data)
--end
--
----- 美食飞行效果
--function FoodBagClaimView:FoodsFlyEffect()
--    this._fsm:ChangeState(this.state.FoodBagClaimFlyItemState,this)
--end
--
--function FoodBagClaimView:OnDestroy()
--    self:UnRegisterEvent()
--    self:Close()
--    --Cache.unload_ab(AssetList["FoodBagClaimAtlas"])
--end
--
--local lastClickTime = 0
--
--function FoodBagClaimView:on_btn_get_click()
--    local foodBags = ModelList.CityModel:GetCityFoodBag()
--    if #foodBags >0 then
--        if UnityEngine.Time.time - lastClickTime >1  and this._fsm:GetCurState().name == this.state.FoodBagClaimIdleState then
--            ModelList.CityModel:C2S_OpenBox( {}, 1, ModelList.CityModel:GetEnterGameMode())
--            lastClickTime = UnityEngine.Time.time
--        end
--    end
--end
--
--function FoodBagClaimView:PlayDouble()
--    this.view:Play("Double")
--end
--
--
--function FoodBagClaimView:PlayFoodNumDouble()
--    this.bagAnima:Play("bianse")
--end
--
--return this
--
--
--
--
--
--
--
--
--
--
