---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by PC.
--- DateTime: 2022/2/12 10:25
---

local CardJackpotEffect = Clazz(ClazzBase, "CardJackpotEffect")
local this = CardJackpotEffect

function CardJackpotEffect:Init(cardView, cotainer)
    this.cardView = cardView
    this.cotainer = cotainer
    --this.model =  ModelList.BattleModel:GetCurrModel()
end

function CardJackpotEffect:PlayShine()
    local bingoView = this.cardView:GetParentView()
    local animaName = "shine"
    
    local playType = ModelList.BattleModel:GetGameType()
    if playType == PLAY_TYPE.PLAY_TYPE_VICTORY_BEATS then
        animaName = "shine_loop"
        local jackpotView = bingoView.jackpotView
        if jackpotView then
            local check = jackpotView.curCount >= jackpotView.totalCount and jackpotView.selfRank == 0
            --名次不够了
            if check then
                return
            end
        end
    end

    if playType == PLAY_TYPE.PLAY_TYPE_VICTORY_BEATS then
        --等jackpot效果展示完
        LuaTimer:SetDelayFunction(2.5, function()
            local jackpotRoot = bingoView.Jackpot
            if jackpotRoot then
                local anima = fun.get_component(jackpotRoot, fun.ANIMATOR)
                if anima then
                    anima:Play(animaName)
                end
                UISound.play("jackpot_twinkle")
            end
        end, nil, LuaTimer.TimerType.Battle)
    else
        local jackpotRoot = bingoView.Jackpot
        if jackpotRoot then
            local anima = fun.get_component(jackpotRoot, fun.ANIMATOR)
            if anima then
                anima:Play(animaName)
            end
            UISound.play("jackpot_twinkle")
        end
    end
end

return this