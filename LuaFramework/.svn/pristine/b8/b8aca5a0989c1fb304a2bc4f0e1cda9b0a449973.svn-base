---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Administrator.
--- DateTime: 25/10/2024 下午 2:17
---


require("View/Bingo/SettleModule/State/BaseSettleState")

local SettleSmallGameState = Clazz(BaseSettleState,"SettleSmallGameState")
local this = SettleSmallGameState
function SettleSmallGameState:New(view)
    local o = {}
    setmetatable(o,{__index = SettleSmallGameState})
    o.view = view
    return o
end


function SettleSmallGameState:OnEnter(fsm,prvious,...)
    this:OpenSmallGameView()
end

function SettleSmallGameState:OpenSmallGameView( )
    local gameType = ModelList.BattleModel:GetGameType()
    if gameType == PLAY_TYPE.PLAY_TYPE_SCRATCH_WINNER then
        if ViewList.ScratchWinnerExtraBallView ~= nil then
            Facade.SendNotification(NotifyName.CloseUI,ViewList.ScratchWinnerExtraBallView)
        end
        ViewList.ScratchWinnerExtraBallView = nil
        ViewList.ScratchWinnerExtraBallView = require("View/Bingo/SettleModule/UIView/ScratchWinnerExtraBallView")
        Facade.SendNotification(NotifyName.ShowUI, ViewList.ScratchWinnerExtraBallView, function ()
            --fun.set_active(this.sumary, false, false)
            ViewList.ScratchWinnerExtraBallView:ReadyForCurrentView()
        end, false, function ()
            ViewList.GameSettleView:JumpNextView()

        end)
    elseif gameType == PLAY_TYPE.PLAY_TYPE_GOLD_TRAIN then  --金币火车玩法，跳转到金币火车结算界面
        if ViewList.SettleGoldenTrainPerformanceView ~= nil then
            Facade.SendNotification(NotifyName.CloseUI,ViewList.SettleGoldenTrainPerformanceView)
        end
        ViewList.SettleGoldenTrainPerformanceView = nil
        ViewList.SettleGoldenTrainPerformanceView = require("View/Bingo/SettleModule/UIView/SettleGoldenTrainPerformanceView")
        Facade.SendNotification(NotifyName.ShowUI, ViewList.SettleGoldenTrainPerformanceView, function ()
            ViewList.SettleGoldenTrainPerformanceView:ReadyForCurrentView()
        end, false, function ()
            ViewList.GameSettleView:JumpNextView()

        end)
    elseif gameType == PLAY_TYPE.PLAY_TYPE_CHRISTMAS_SYNTHESIS then
        if ViewList.ChristmasSynthesisExtraBallView ~= nil then
            Facade.SendNotification(NotifyName.CloseUI, ViewList.ChristmasSynthesisExtraBallView)
        end
        ViewList.ChristmasSynthesisExtraBallView = nil
        ViewList.ChristmasSynthesisExtraBallView = require("View/Bingo/SettleModule/UIView/ChristmasSynthesisExtraBallView")
        Facade.SendNotification(NotifyName.ShowUI, ViewList.ChristmasSynthesisExtraBallView, function ()
            --fun.set_active(this.sumary, false, false)
            ViewList.ChristmasSynthesisExtraBallView:ReadyForCurrentView()
        end, false, function ()
            ViewList.GameSettleView:JumpNextView()
        end)
    elseif gameType == PLAY_TYPE.PLAY_TYPE_NORMAL then
        local mainView = ModelList.SmallGameModel.GetCurrentSGMainViewName()
        if mainView then
            if ViewList[mainView] ~= nil then
                Facade.SendNotification(NotifyName.CloseUI, ViewList[mainView])
            end
            ViewList[mainView] = nil
            ViewList[mainView] = require("View.Bingo.SettleModule.UIView.SmallGame.Normal."..mainView)
            Facade.SendNotification(NotifyName.ShowUI, ViewList[mainView], function ()
                ViewList[mainView]:ReadyForCurrentView()
            end, false, function ()
                ViewList.GameSettleView:JumpNextView()
            end)
        end
    end

    --ViewList.SettleRocketView:SkipLoadShow(view)
end



--function SettleSmallGameState:on_x_update()
--
--end


function SettleSmallGameState:OnLeave(fsm)

end

function SettleSmallGameState:FinishOperate(fsm)
    if fsm then
        --self:ChangeState(fsm,"SettleRankState")
        self:ChangeState(fsm,"SettleClimbRankState")
    end
end

return SettleSmallGameState
