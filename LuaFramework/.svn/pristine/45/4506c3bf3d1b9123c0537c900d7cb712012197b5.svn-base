---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by PC.
--- DateTime: 2022/2/25 14:19
---
---@class BaseMachine
BaseMachine = {}
local this = BaseMachine
this.update_x_enabled = false --开启独立刷新
this.machineOpen = true
function BaseMachine:New(machineName)
    local o = {machineName = machineName}
    setmetatable(o, { __index = BaseMachine });
    return o;
end

function BaseMachine:stop_x_update()
    if not self.update_x_enabled then return end
    if self.update_x_handler then
        UpdateBeat:RemoveListener(self.update_x_handler)
        self.update_x_handler = nil
    end
end

function BaseMachine:start_x_update()
    if not self.update_x_enabled then return end
    self:stop_x_update()
    self.invoke_x_list = {}
    self.start_time = fun.get_real_time_since_startup()
    self.update = xp_call(function()
        self:on_x_update()
    end)

    self.update_x_handler = UpdateBeat:CreateListener(self.update)
    UpdateBeat:AddListener(self.update_x_handler)
end

function BaseMachine:on_x_update() end

--初始化开发ui ，正式环境不显示
function BaseMachine:on_init_dev_ui()
    if self.dev_mode_ui_list then
        local bool = AppConst.DevMode
        for i, v in ipairs(self.dev_mode_ui_list) do
            if self[v] then
                fun.set_active(self[v], bool)
            end
        end
    end
end

function BaseMachine:set_machine_open(cfg)
        this.machineOpen = (cfg == 1)
end

function BaseMachine:is_machine_open()
    return this.machineOpen
end

return this