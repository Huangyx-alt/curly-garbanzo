---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by PC.
--- DateTime: 2024/3/17 11:27
---


local RouletteFree = require "GamePlayShortPass.Base.BaseRouletteFree"
local RouletteFee = require "GamePlayShortPass.Base.BaseRouletteFee"

local BaseRouletteView = BaseView:New("PassSpinRewardView","RouletteAtlas")
local this = BaseRouletteView
this.viewType = CanvasSortingOrderManager.LayerType.TopConsole

local childView = nil
this.isCleanRes = true
this.auto_bind_ui_items = {
    "spinOrdinary",
    "spinFee",
    "anima",
}

function BaseRouletteView:Awake(obj)
    self:on_init()
end

function BaseRouletteView:OnEnable(params)
    Facade.RegisterView(self)
    local isFee = ModelList.GameActivityPassModel:IsFeeAvailable(true)
    if isFee then
        self:SetFeeStyle()
    else
        self:SetFreeStyle()
    end
end

function BaseRouletteView:OnDisable()
    Facade.RemoveView(self)
    ModelList.GameActivityPassModel:ResetRouletteInfo()
    childView = nil
end

function BaseRouletteView:SetFreeStyle()
    fun.set_active(self.spinOrdinary.transform,true)
    fun.set_active(self.spinFee.transform,false)
    childView = RouletteFree:New("RouletteFree")
    childView:SkipLoadShow(self.spinOrdinary,true,nil,{super = self,isFromFree = false})
end

function BaseRouletteView:SetFeeStyle(isFromFree)

    if fun.get_active_self(self.spinFee.transform) then
        return
    end

    fun.set_active(self.spinFee.transform,true)
    childView = RouletteFee:New("RouletteFee")
    childView:SkipLoadShow(self.spinFee,true,nil,{super = self,isFromFree = isFromFree})
end

function BaseRouletteView:PlayFreeEnter(callback)
    AnimatorPlayHelper.Play(self.anima,{"free_in","SpinRewardfreeenter"},false,function()
        if callback then
            callback()
        end
    end)
end

function BaseRouletteView:PlayVipEnter(callback)
    AnimatorPlayHelper.Play(self.anima,{"VIP_in","SpinRewardVIPin"},false,function()
        if callback then
            callback()
        end
    end)
end

function BaseRouletteView:PlayChange2Vip(callback)
    AnimatorPlayHelper.Play(self.anima,{"vip_enter","SpinRewardVIPenter"},false,function()
        fun.set_active(self.spinOrdinary.transform,false)
        if callback then
            callback()
        end
    end)
end

function BaseRouletteView:PlayVipExit(callback)
    if childView then
        childView:PlayButtonExit()
    end
    UISound.play("turntable_upgrade")
    AnimatorPlayHelper.Play(self.anima,{"VIP_end","SpinRewardVIPend"},false,function()
        if callback then
            callback()
        end
    end)
end

function BaseRouletteView:PlayFreeSpin()
    AnimatorPlayHelper.Play(self.anima,{"free_spin","SpinRewardfreespin"},false,function()

    end)
end

function BaseRouletteView:PlayFreeShowReward()
    AnimatorPlayHelper.Play(self.anima,{"free_win","SpinRewardfreewin"},false,function()
        UISound.play("turntable_win")
    end)
end

function BaseRouletteView:PlayFeeSpin()
    AnimatorPlayHelper.Play(self.anima,{"VIP_spin","SpinRewardVIPspin"},false,function()

    end)
end

function BaseRouletteView:PlayFeeShowReward()
    AnimatorPlayHelper.Play(self.anima,{"VIP_win","SpinRewardVIPwin"},false,function()

    end)
end

function BaseRouletteView:PlayRouletteIdle()
    if fun.get_active_self(self.spinFee.transform) then -- ����ת�̣��������������쳣�˳�
        Facade.SendNotification(NotifyName.Roulette.ExitRoulette,true)
        return
    end
    AnimatorPlayHelper.Play(self.anima,{"free_idle","SpinRewardfreeidle"},false,function()

    end)
end

function BaseRouletteView:PlayChange2FeeStyle()
    AnimatorPlayHelper.Play(self.anima,{"VIP_idle","SpinRewardVIPidle"},false,function()

    end)
end

return this