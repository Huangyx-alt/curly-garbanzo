---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by PC.
--- DateTime: 2024/2/20 20:54
---

local anniversaryBuff = {}
local this = anniversaryBuff

function anniversaryBuff:New(view)
    local o = {}
    setmetatable(o, { __index = this })
    o.view = view
    return o
end

function anniversaryBuff:CheckDuringBuff(parentObj,clone,offsetX,offsetY,index)
    local anniversaryInfo = ModelList.FixedActivityModel:GetAnniversaryInfo()
    if anniversaryInfo and anniversaryInfo.isAnniversaryActive then
      return  self:Show(parentObj,clone,offsetX,offsetY,index)
    end
end


function anniversaryBuff:CheckAnniversaryBuff(parentObj,localPos,index)
    local anniversaryInfo = ModelList.FixedActivityModel:GetAnniversaryInfo()
    if anniversaryInfo and anniversaryInfo.isAnniversaryActive then
        return self:Show2(parentObj,localPos,index)
    end
end


function anniversaryBuff:Show(parentObj,clone,offsetX,offsetY,index)
    local buff = fun.get_instance(clone,parentObj)
    if buff then
        buff.name = "AnniversaryBuffFlag"
        buff.transform:SetSiblingIndex(clone.transform:GetSiblingIndex() + 1)
        local buffSprite = fun.get_component(buff,fun.IMAGE)
        if buffSprite then
            buffSprite.raycastTarget = false
            Cache.load_sprite(AssetList["AnniversaryBuff"..index],"AnniversaryBuff"..index,function(sprite)
                if sprite then
                    local pos = fun.get_gameobject_pos(buff,true)
                    fun.set_transform_pos(buff.transform,pos.x+offsetX, pos.y+offsetY,pos.z,true)
                    buffSprite.sprite = sprite
                    buffSprite:SetNativeSize()
                end
            end)
        end
        fun.set_active(buff,true)
        return buff
    end
end

function anniversaryBuff:Show2(parentObj,localPos,index)
    local buff = GameObject.New("AnniversaryBuffFlag")
    local buffSprite = fun.add_component(buff,UnityEngine.UI.Image)
    fun.set_parent(buff,parentObj,true)
    if buff then
        if buffSprite then
            buffSprite.raycastTarget = false
            Cache.load_sprite(AssetList["AnniversaryBuff"..index],"AnniversaryBuff"..index,function(sprite)
                if sprite then
                    if localPos then
                        fun.set_transform_pos(buff.transform,localPos.x, localPos.y,localPos.z,true)
                    end
                    buffSprite.sprite = sprite
                    buffSprite:SetNativeSize()
                end
            end)
        end
        fun.set_active(buff,true)
        return buff
    end
end

return this
