---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by PC.
--- DateTime: 2021/12/23 18:21
---

---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by PC.
--- DateTime: 2021/6/24 14:32
---


local GuideView = BaseView:New('GuideView', "GuideAtlas")
local this = GuideView
this.viewType = CanvasSortingOrderManager.LayerType.ErrorDialog


this.auto_bind_ui_items = {
    "MaskBG",
    "Mask",
    "Dialog",
    "AvatarBubbleTips",
    "BubbleTips",
    "BubbleTips2",
    "MiddleTips",
    "GD1",
    "CirclePass2",
    "CirclePass1",
    "ClickTrigger",
    "AreaClickr",
    "TalkScrollView",
    "SkipBtn",
    "FingerDrag",
    "CardEnd",
    "NormalArrow",
    "Arrow",
    "SwitchCity",
    "PowerUpAutoFinger",
    "GD2",
    "efGuideBuycard",
    "efGuideFree",
    "efGuideMake",
    "efGuideRocket",
    "efGuideMax",
    "CircleThreePu",
    "efGuideBuyPu",
    "GD3",
    "GD4",

}

function GuideView:GetRootView()
    if SceneViewManager.gobal_layer == nil then
        SceneViewManager.gobal_layer = UnityEngine.GameObject.FindWithTag("GlobalUiRoot")
    end
    local parent = SceneViewManager.gobal_layer
    return parent
end

function GuideView:Awake()
    this:on_init()
end

function GuideView:HideAllPanel()
    for k, v in pairs(this.auto_bind_ui_items) do
        if this[v] then
            fun.set_active(this[v], false)
        end
    end
end

function GuideView:OnEnable()
    log.r("GuideView:OnEnable")
    if not ModelList.GuideModel.IsGuiding() and self and self.go then
        fun.set_active(self.go, false)
        log.r("GuideView:OnEnable hide self")
    end
    --local ret  = fun.get_component(ViewList.HallCityView.go,fun.RECT)
    --fun.ForceRebuildLayoutImmediate(ViewList.HallCityView.go)
end

function GuideView:OpenThreePu(path, isActive, offset)
    local child = fun.find_child(this.go, "Panel/CircleThreePu/efGuideBuyPu")
    if child then
        fun.set_active(child, isActive)
        if isActive then
            path = string.sub(path, 14)
            local target = fun.find_child(ViewList.HallMainView.go, path)
            fun.set_same_position_with(child, target)
            if offset then
                local pos = fun.get_localposition(child)
                fun.set_rect_local_pos(child, pos.x - 338.4891, pos.y + 174.7827, 0)
            end
        end
    end
end

return this
