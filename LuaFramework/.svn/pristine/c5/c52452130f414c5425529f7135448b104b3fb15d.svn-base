---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by PC.
--- DateTime: 2022/2/23 11:24
---
---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by PC.
--- DateTime: 2021/10/19 17:36
---
local CommonPopupView = require("View.CommonTipView.CommonPopupView")
local NetworkGlobalPopupView = CommonPopupView:New()
NetworkGlobalPopupView.viewName = ""
local this = NetworkGlobalPopupView
this.viewType = CanvasSortingOrderManager.LayerType.Popup_Dialog
this.sure_cb = nil
this.cancel_cb = nil
--local this = NetworkGlobalPopupView;


this.auto_bind_ui_items = {
    "btn_sure",
    "btn_cancle",
    "content",
    "title",
    "btn_close"
}

this.sure_cb = nil
this.cancel_cb = nil

--params @oktype  0:普通双按钮  1: 普通单按钮    2: 错误双按钮  3: 错误单按钮    4: 全局双按钮    5: 全局单按钮
function NetworkGlobalPopupView:SetInfo(go, contentId, isSingleBtn, sure_cb, cancel_cb, params)
    if contentId then
        local tip_type = Csv.GetData("description", contentId, "params") or "1"
        local content = Csv.GetData("description", contentId, "description")
        if tip_type == "2" then self.title.sprite = AtlasManager:GetSpriteByName("BingoBangPopupAtlas", "TYAYS")
        elseif tip_type == "3" then self.title.sprite = AtlasManager:GetSpriteByName("BingoBangPopupAtlas", "TYERROR")
        else self.title.sprite = AtlasManager:GetSpriteByName("BingoBangPopupAtlas", "TYTips")  end
        self.title:SetNativeSize()
        fun.set_child_layer(self.go,"FakeUI")
        if tip_type == "2" then self.title.sprite = AtlasManager:GetSpriteByName("BingoBangPopupAtlas", "TYAYS")
        elseif tip_type == "3" then self.title.sprite = AtlasManager:GetSpriteByName("BingoBangPopupAtlas", "TYERROR")
        elseif tip_type == "1" then self.title.sprite = AtlasManager:GetSpriteByName("BingoBangPopupAtlas", "TYTips")  end
        self.title:SetNativeSize()
        if params and #params > 0 and string.find(content,"%%s") then
            content = string.format(content, unpack(params))
        end
        self.content.text = content
        self.sure_cb = sure_cb
        self.cancel_cb = cancel_cb
        if isSingleBtn then
            fun.set_active(self.btn_cancle, false)
            local pos = fun.get_gameobject_pos(self.btn_sure, true)
            fun.set_gameobject_pos(self.btn_sure, 0, pos.y, pos.z, true)
        end
        this:SaveViewInfo(contentId)
    end
end

function NetworkGlobalPopupView:SaveViewInfo(contentId)
    if contentId == 8000 then
        Net.AddTipView(this,"CheckConnection")
    elseif contentId == 8005 then
        Net.AddTipView(this,"ReloginTip")
    end
end


function NetworkGlobalPopupView:GetRootView()
    if  SceneViewManager.gobal_layer == nil then
        SceneViewManager.gobal_layer = UnityEngine.GameObject.FindWithTag("GlobalUiRoot")
    end
    local parent =   SceneViewManager.gobal_layer
    return parent
end

function NetworkGlobalPopupView:on_btn_close_click()
    Net.CloseTipView(self)
    if self.cancel_cb then    self.cancel_cb()  end
    Facade.SendNotification(NotifyName.HideDialog, self)
end

function NetworkGlobalPopupView.NewPop(o)
    --如果o为false或者o为nil，则让o为{}
    o = o or {viewName ="CommonPopupView",atlasName = "BingoBangPopupAtlas"}
    setmetatable(o,{__index = this})
    if o.go ~= nil then log.e ("NewPop   not nil ") end
    return o
end

return this






